# -*- coding: utf-8 -*-
"""PRML A1 Q1.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/177bB00P2_sl96kfd19C0aW-NIMmGcYo2
"""

from torchvision.datasets import MNIST
import torch
import numpy as np
train_data = MNIST(root='/content/', train=True, download=True)

"""# Question 1 : **Principal Component Analysis**

---
## **Vanilla Principal Component Analysis**
---

### Main Function to Impliment Algorithm

#### Obtaining workable sized Dataset
"""

x = train_data.data.numpy()
X_train = x.reshape(x.shape[0], -1)   #flattening all features
y_train = train_data.targets.numpy()

data = np.zeros((1000,784))
dy = np.zeros(1000)

for i in range(10):
  t = 0
  j = 0
  while j < 100:
    if y_train[t] == i:
      data[i*100+j] = X_train[t]
      dy[i*100+j] = y_train[t]
      j+=1

    t+=1                                # all labels have random 100 pictures each

import pandas as pd
df = pd.DataFrame(dy)

from matplotlib import pyplot as plt
df[0].plot(kind='hist', bins=100, title=0)

print("We can see each Label (0-9) has random allocations from the original dataset")

"""#### Centering Dataset"""

center = np.mean(data, axis = 0)    # meu_1
x_c = data - center                 # Centered Dataset
#x_c = x_c.T

C = np.cov(x_c.T) #Covariance Matrix
C

"""#### Function:   **Eigen Decomposer**"""

#Using linalg function to calculate the eigen vectors and the eigen values of the data point
def eigen_decompose(M):
  v, w = np.linalg.eig(M)
  id = v.argsort()[::-1]

  v = v[id]
  w = w[:,id]

  return v,w

"""#### Function:   **Looking at only the top k dimensions or top k components**"""

λ, w = eigen_decompose(C)
def reconstructed(k):
  w_k = w[:,0:k]
  P = w_k @ w_k.T
  new_data = P @ x_c.T
  new_data = ((new_data.T + center).T).real

  return new_data

"""### Observation and Results

#### Plotting the Principal Components individually
"""

plt.figure(figsize=(8, 6))

def imager(ki,ko,d = 1):
  r=2
  plt.figure(figsize=(8, 6))
  for i in range(ki,ko,d):
    plt.subplot(r,5,i+1)
    plt.imshow(w[:,i].real.reshape((28,28)), cmap = 'gray')
    plt.tick_params(bottom=False, left=False, labelbottom=False, labelleft=False)
    plt.title("ω%d" %(i+1))
  plt.show()
  plt.figure(figsize=(8, 6))

  for i in range(ki,ko,d):
    plt.subplot(r+1,5,i+1)
    plt.imshow(w[:,i].real.reshape((28,28)), cmap = 'PiYG')
    plt.tick_params(bottom=False, left=False, labelbottom=False, labelleft=False)
    #plt.title("ω%d" %(i+1))
  plt.show()
  plt.figure(figsize=(8, 6))

imager(0,5)
imager(5,10)

plt.figure(figsize=(12, 8))
for i in range(1,29):
  plt.subplot(4,7,i)
  plt.imshow(w[:,i*i-1].real.reshape((28,28)), cmap = 'gray')
  plt.tick_params(bottom=False, left=False, labelbottom=False, labelleft=False)
  plt.title("ω%d" %(i*i))
plt.show()
plt.figure(figsize=(8, 8))

"""#### Plotting the New Image with top d Components"""

#Reconstructing a random point from each label
for j in range(10):
  plt.figure(figsize=(14, 10))
  for i in range(11):
    new_img = reconstructed((i+1)*(i+1))
    plt.subplot(1,11,i+1)

    plt.imshow(new_img[:,100*j+3].reshape((28,28)), cmap = "gray")
    plt.tick_params(bottom=False, left=False, labelbottom=False, labelleft=False)
    plt.title("d = %d" %((i+1)*(i+1)))
  #plt.show()

"""#### Plotting Eigen values to gauge the Cumulative importance of top 'i' Eigen vectors"""

import seaborn as sns
plt.plot(100*λ/np.sum(λ), '.', color = "black")
plt.title("Component wise importance in (%)", fontsize=16, color='blue', ha='center')
plt.xlabel("nth Component")
plt.ylabel("Percentage") # Percentage of non repeated Informtion captured by PCA

s = np.zeros(784)
s[0] = λ[0]
for i in range(1,784):
  s[i] = s[i-1] + λ[i]
s = 100*s/s[783]


import seaborn as sns
plt.plot(s)
plt.plot(76, s[76], '*', color = 'r')
s[0] = λ[0]
plt.text(240, 90, "<- Here Σλi > 90 %", ha='center', va='center', fontsize=12)
plt.text(240, 82, "i = 76", ha='center', va='center', fontsize=12)
plt.title("Cumulative importance of first n components (in %)", fontsize=16, color='blue', ha='center')
plt.xlabel("nth Component")
plt.ylabel("Percentage")

"""---
## **Kernel Principal Component Analysis**
---

![image.png](data:image/png;base64,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)

### Main Program to Impliment Algorithm

### Function: **The Polynomial Kernel Function**
"""

def polynomial_kernel(Map, d):
  n = Map.shape[1]
  one = (1/n)*np.ones((n,n))
  K = np.zeros((n,n))
  for i in range(n):         # Making the Kernel matrix K
    for j in range(i,n):
      x = Map[:, i]
      y = Map[:, j]
      K[i][j] = (1 + x.dot(y))**d   #  equations of K1
      K[j][i] = (1 + x.dot(y))**d   #  equations of K2

  K_polynomial = K - one.dot(K) - K.dot(one) + one.dot(K).dot(one)
  return K_polynomial

comp = 2   # The top 2 components are shown
def pk_plot(d,clrr,col,dots = 15):
  xnorm = x_c.T / np.linalg.norm(x_c.T, axis = 0)
  K = polynomial_kernel(xnorm, d)
  λ, wc = eigen_decompose(K)
  w = wc[:, :comp]

  X_kpca = K @ w
  X_kpca = X_kpca.real          # weed out some minute values of imaginary numbers

  plt.scatter(X_kpca[:, 0], X_kpca[:, 1], color = clrr, s= dots)

  if col == 1:
    labels = ['d = 2 (Magenta)', 'd = 3 (Blue)','d = 4 (green)', 'd = 5 (Red)','d = 6(Cyan)','d = 7(black)' ]  # Custom labels
    #'m': ' Word', 'b': 'Blue Word', 'g': 'Green Word',
    #      'r': 'Red Word', 'c': 'Cyan Word', 'w': 'White Word'
    plt.legend(labels=labels)

  else:
    labels = ['d ='+ str(d)] # Custom labels
    plt.legend(labels=labels)

  plt.xlabel('KPC 1')
  plt.ylabel('KPC 2')

"""### Function: **The Radial basis Kernel Function**"""

def kernelb(Map, σ):
  n = Map.shape[1]
  #print(n)
  rbf = np.zeros((n,n))
  one = (1/n)*np.ones((n,n))

  for i in range(n):
    for j in range(i,n):     #symmetric
      xval = Map[:,i]
      yval = Map[:,j]
      rbf[i][j] = (np.linalg.norm(xval - yval))**2
      rbf[j][i] = rbf[i][j]

  K  = np.exp(-rbf/(σ))
  K = K - one.dot(K) - K.dot(one) + one.dot(K).dot(one)
  return K

σ=7      # sigma allocator
def rbf_plotter(σ=7):
  xn = x_c.T / np.linalg.norm(x_c.T, axis = 0)
  K = kernelb(xn, σ)
  eigv, eigvect = eigen_decompose(K)
  w = eigvect[:, :2]
  σ_pca = K @ w
  σ_pca = σ_pca.real     #  weed out some minute values of imaginary numbers

  return σ_pca

"""### Observations and Plotting

#### Principal Coponent Analysis using Polynomial Kernel functions
"""

clrr = ['m','b','g','r','c','k']

for i in range(2,5):
  pk_plot(i, clrr[i-2],1,3)

plt.title("Kernel Polynomial of dimension(d) ∈ {2,3,4} ")
plt.show()

clrr = ['m','b','g','r','c','k']

for i in range(2,8):
  pk_plot(i, clrr[i-2],1,1)

plt.title("Kernel Polynomial of dimension(d) ∈ {2,3,4,5,6,7,8} ")
plt.show()

plt.figure(figsize=(20, 5))
for i in range(2,5):

  plt.subplot(1,3 ,i-1)
  plt.xlim(-60, 30)
  plt.ylim(-30, 30)
  s  = 'd' + str(i)
  pk_plot(i, clrr[i-2], 2 )
  plt.title('Kernel PCA of Dimension ' + str(i))

"""#### Principal Component Analysis using Radial Kernel Function"""

plt.figure(figsize=(10, 5))
for sigs in range(2,8):
  result = rbf_plotter(sigs)

  for i in range(1000):
    plt.subplot(2,3 ,sigs-1)
    plt.xlim(-3, 3)
    plt.ylim(-3, 3)

    plt.scatter(result[i, 0], result[i, 1], c = 'm',s = 1)
  plt.xlabel('KPC 1')
  plt.ylabel('KPC 2')
  plt.title('σ = '+ str(sigs))

